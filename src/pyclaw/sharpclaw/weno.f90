! This file was generated by: python weno.py
module weno
contains
  subroutine weno5(q, ql, qr, num_eqn, maxnx, num_ghost)

    implicit none

    integer,          intent(in)  :: num_eqn, maxnx, num_ghost
    double precision, intent(in)  :: q(num_eqn,maxnx+2*num_ghost)
    double precision, intent(out) :: ql(num_eqn,maxnx+2*num_ghost), qr(num_eqn,maxnx+2*num_ghost)

    integer :: i, m
    double precision :: sigma0, &
         sigma1, &
         sigma2, &
         omega1, &
         omega5, &
         omega0, &
         omega4, &
         omega3, &
         omega2, &
         fr1, &
         fr5, &
         fr0, &
         fr4, &
         fr3, &
         fr2, &
         fs0, &
         fs1

    do i = num_ghost-1, maxnx+num_ghost+1
       do m = 1, num_eqn
          sigma0 = 3.3333333333333333333333333333333333d0*q(m,i+0)*q(m,i+0) - &
               10.333333333333333333333333333333333d0*q(m,i+0)*q(m,i+1) + &
               3.6666666666666666666666666666666667d0*q(m,i+0)*q(m,i+2) + &
               8.3333333333333333333333333333333333d0*q(m,i+1)*q(m,i+1) - &
               6.3333333333333333333333333333333333d0*q(m,i+1)*q(m,i+2) + &
               1.3333333333333333333333333333333333d0*q(m,i+2)*q(m,i+2)
          sigma1 = 4.3333333333333333333333333333333333d0*q(m,i+0)*q(m,i+0) - &
               4.3333333333333333333333333333333333d0*q(m,i+0)*q(m,i+1) - &
               4.3333333333333333333333333333333333d0*q(m,i+0)*q(m,i-1) + &
               1.3333333333333333333333333333333333d0*q(m,i+1)*q(m,i+1) + &
               1.6666666666666666666666666666666667d0*q(m,i+1)*q(m,i-1) + &
               1.3333333333333333333333333333333333d0*q(m,i-1)*q(m,i-1)
          sigma2 = 3.3333333333333333333333333333333333d0*q(m,i+0)*q(m,i+0) - &
               10.333333333333333333333333333333333d0*q(m,i+0)*q(m,i-1) + &
               3.6666666666666666666666666666666667d0*q(m,i+0)*q(m,i-2) + &
               8.3333333333333333333333333333333333d0*q(m,i-1)*q(m,i-1) - &
               6.3333333333333333333333333333333333d0*q(m,i-1)*q(m,i-2) + &
               1.3333333333333333333333333333333333d0*q(m,i-2)*q(m,i-2)
          omega0 = 0.1d0/(sigma0 + 0.00000099999999999999995474811182588625869d0)*(sigma0 + &
               0.00000099999999999999995474811182588625869d0)
          omega1 = 0.6d0/(sigma1 + 0.00000099999999999999995474811182588625869d0)*(sigma1 + &
               0.00000099999999999999995474811182588625869d0)
          omega2 = 0.3d0/(sigma2 + 0.00000099999999999999995474811182588625869d0)*(sigma2 + &
               0.00000099999999999999995474811182588625869d0)
          omega3 = 0.3d0/(sigma0 + 0.00000099999999999999995474811182588625869d0)*(sigma0 + &
               0.00000099999999999999995474811182588625869d0)
          omega4 = 0.6d0/(sigma1 + 0.00000099999999999999995474811182588625869d0)*(sigma1 + &
               0.00000099999999999999995474811182588625869d0)
          omega5 = 0.1d0/(sigma2 + 0.00000099999999999999995474811182588625869d0)*(sigma2 + &
               0.00000099999999999999995474811182588625869d0)
          fr0 = 1.8333333333333333333333333333333333d0*q(m,i+0) - &
               1.1666666666666666666666666666666667d0*q(m,i+1) + &
               0.33333333333333333333333333333333333d0*q(m,i+2)
          fr1 = 0.83333333333333333333333333333333333d0*q(m,i+0) - &
               0.16666666666666666666666666666666667d0*q(m,i+1) + &
               0.33333333333333333333333333333333333d0*q(m,i-1)
          fr2 = 0.33333333333333333333333333333333333d0*q(m,i+0) + &
               0.83333333333333333333333333333333333d0*q(m,i-1) - &
               0.16666666666666666666666666666666667d0*q(m,i-2)
          fr3 = 0.33333333333333333333333333333333333d0*q(m,i+0) + &
               0.83333333333333333333333333333333333d0*q(m,i+1) - &
               0.16666666666666666666666666666666667d0*q(m,i+2)
          fr4 = 0.83333333333333333333333333333333333d0*q(m,i+0) + &
               0.33333333333333333333333333333333333d0*q(m,i+1) - &
               0.16666666666666666666666666666666667d0*q(m,i-1)
          fr5 = 1.8333333333333333333333333333333333d0*q(m,i+0) - &
               1.1666666666666666666666666666666667d0*q(m,i-1) + &
               0.33333333333333333333333333333333333d0*q(m,i-2)
          fs0 = (fr0*omega0 + fr1*omega1 + fr2*omega2)/(omega0 + omega1 + omega2)
          fs1 = (fr3*omega3 + fr4*omega4 + fr5*omega5)/(omega3 + omega4 + omega5)
          ql(m,i) = fs0
          qr(m,i) = fs1
       end do
    end do

  end subroutine weno5

  subroutine weno7(q, ql, qr, num_eqn, maxnx, num_ghost)

    implicit none

    integer,          intent(in)  :: num_eqn, maxnx, num_ghost
    double precision, intent(in)  :: q(num_eqn,maxnx+2*num_ghost)
    double precision, intent(out) :: ql(num_eqn,maxnx+2*num_ghost), qr(num_eqn,maxnx+2*num_ghost)

    integer :: i, m
    double precision :: sigma0, &
         sigma1, &
         sigma2, &
         sigma3, &
         omega1, &
         omega6, &
         omega0, &
         omega2, &
         omega7, &
         omega4, &
         omega3, &
         omega5, &
         fr1, &
         fr6, &
         fr0, &
         fr2, &
         fr7, &
         fr4, &
         fr3, &
         fr5, &
         fs0, &
         fs1

    do i = num_ghost-1, maxnx+num_ghost+1
       do m = 1, num_eqn
          sigma0 = 8.7791666666666666666666666666666667d0*q(m,i+0)*q(m,i+0) - 39.175d0*q(m, &
               i+0)*q(m,i+1) + 29.341666666666666666666666666666667d0*q(m,i+0)*q &
               (m,i+2) - 7.725d0*q(m,i+0)*q(m,i+3) + &
               45.845833333333333333333333333333333d0*q(m,i+1)*q(m,i+1) - &
               71.858333333333333333333333333333333d0*q(m,i+1)*q(m,i+2) + &
               19.341666666666666666666666666666667d0*q(m,i+1)*q(m,i+3) + &
               29.345833333333333333333333333333333d0*q(m,i+2)*q(m,i+2) - &
               16.175d0*q(m,i+2)*q(m,i+3) + &
               2.2791666666666666666666666666666667d0*q(m,i+3)*q(m,i+3)
          sigma1 = 14.345833333333333333333333333333333d0*q(m,i+0)*q(m,i+0) - &
               24.858333333333333333333333333333333d0*q(m,i+0)*q(m,i+1) + &
               6.675d0*q(m,i+0)*q(m,i+2) - &
               10.508333333333333333333333333333333d0*q(m,i+0)*q(m,i-1) + &
               11.845833333333333333333333333333333d0*q(m,i+1)*q(m,i+1) - &
               6.8416666666666666666666666666666667d0*q(m,i+1)*q(m,i+2) + &
               8.0083333333333333333333333333333333d0*q(m,i+1)*q(m,i-1) + &
               1.1125d0*q(m,i+2)*q(m,i+2) - &
               2.0583333333333333333333333333333333d0*q(m,i+2)*q(m,i-1) + &
               2.2791666666666666666666666666666667d0*q(m,i-1)*q(m,i-1)
          sigma2 = 14.345833333333333333333333333333333d0*q(m,i+0)*q(m,i+0) - &
               10.508333333333333333333333333333333d0*q(m,i+0)*q(m,i+1) - &
               24.858333333333333333333333333333333d0*q(m,i+0)*q(m,i-1) + &
               6.675d0*q(m,i+0)*q(m,i-2) + &
               2.2791666666666666666666666666666667d0*q(m,i+1)*q(m,i+1) + &
               8.0083333333333333333333333333333333d0*q(m,i+1)*q(m,i-1) - &
               2.0583333333333333333333333333333333d0*q(m,i+1)*q(m,i-2) + &
               11.845833333333333333333333333333333d0*q(m,i-1)*q(m,i-1) - &
               6.8416666666666666666666666666666667d0*q(m,i-1)*q(m,i-2) + &
               1.1125d0*q(m,i-2)*q(m,i-2)
          sigma3 = 8.7791666666666666666666666666666667d0*q(m,i+0)*q(m,i+0) - 39.175d0*q(m, &
               i+0)*q(m,i-1) + 29.341666666666666666666666666666667d0*q(m,i+0)*q &
               (m,i-2) - 7.725d0*q(m,i+0)*q(m,i-3) + &
               45.845833333333333333333333333333333d0*q(m,i-1)*q(m,i-1) - &
               71.858333333333333333333333333333333d0*q(m,i-1)*q(m,i-2) + &
               19.341666666666666666666666666666667d0*q(m,i-1)*q(m,i-3) + &
               29.345833333333333333333333333333333d0*q(m,i-2)*q(m,i-2) - &
               16.175d0*q(m,i-2)*q(m,i-3) + &
               2.2791666666666666666666666666666667d0*q(m,i-3)*q(m,i-3)
          omega0 = 0.028571428571428571428571428571428571d0/(sigma0 + &
               0.00000099999999999999995474811182588625869d0)*(sigma0 + &
               0.00000099999999999999995474811182588625869d0)
          omega1 = 0.34285714285714285714285714285714286d0/(sigma1 + &
               0.00000099999999999999995474811182588625869d0)*(sigma1 + &
               0.00000099999999999999995474811182588625869d0)
          omega2 = 0.51428571428571428571428571428571429d0/(sigma2 + &
               0.00000099999999999999995474811182588625869d0)*(sigma2 + &
               0.00000099999999999999995474811182588625869d0)
          omega3 = 0.11428571428571428571428571428571429d0/(sigma3 + &
               0.00000099999999999999995474811182588625869d0)*(sigma3 + &
               0.00000099999999999999995474811182588625869d0)
          omega4 = 0.11428571428571428571428571428571429d0/(sigma0 + &
               0.00000099999999999999995474811182588625869d0)*(sigma0 + &
               0.00000099999999999999995474811182588625869d0)
          omega5 = 0.51428571428571428571428571428571429d0/(sigma1 + &
               0.00000099999999999999995474811182588625869d0)*(sigma1 + &
               0.00000099999999999999995474811182588625869d0)
          omega6 = 0.34285714285714285714285714285714286d0/(sigma2 + &
               0.00000099999999999999995474811182588625869d0)*(sigma2 + &
               0.00000099999999999999995474811182588625869d0)
          omega7 = 0.028571428571428571428571428571428571d0/(sigma3 + &
               0.00000099999999999999995474811182588625869d0)*(sigma3 + &
               0.00000099999999999999995474811182588625869d0)
          fr0 = 2.0833333333333333333333333333333333d0*q(m,i+0) - &
               1.9166666666666666666666666666666667d0*q(m,i+1) + &
               1.0833333333333333333333333333333333d0*q(m,i+2) - 0.25d0*q(m,i+3)
          fr1 = 1.0833333333333333333333333333333333d0*q(m,i+0) - &
               0.41666666666666666666666666666666667d0*q(m,i+1) + &
               0.083333333333333333333333333333333333d0*q(m,i+2) + 0.25d0*q(m, &
               i-1)
          fr2 = 0.58333333333333333333333333333333333d0*q(m,i+0) - &
               0.083333333333333333333333333333333333d0*q(m,i+1) + &
               0.58333333333333333333333333333333333d0*q(m,i-1) - &
               0.083333333333333333333333333333333333d0*q(m,i-2)
          fr3 = 0.25d0*q(m,i+0) + 1.0833333333333333333333333333333333d0*q(m,i-1) - &
               0.41666666666666666666666666666666667d0*q(m,i-2) + &
               0.083333333333333333333333333333333333d0*q(m,i-3)
          fr4 = 0.25d0*q(m,i+0) + 1.0833333333333333333333333333333333d0*q(m,i+1) - &
               0.41666666666666666666666666666666667d0*q(m,i+2) + &
               0.083333333333333333333333333333333333d0*q(m,i+3)
          fr5 = 0.58333333333333333333333333333333333d0*q(m,i+0) + &
               0.58333333333333333333333333333333333d0*q(m,i+1) - &
               0.083333333333333333333333333333333333d0*q(m,i+2) - &
               0.083333333333333333333333333333333333d0*q(m,i-1)
          fr6 = 1.0833333333333333333333333333333333d0*q(m,i+0) + 0.25d0*q(m,i+1) - &
               0.41666666666666666666666666666666667d0*q(m,i-1) + &
               0.083333333333333333333333333333333333d0*q(m,i-2)
          fr7 = 2.0833333333333333333333333333333333d0*q(m,i+0) - &
               1.9166666666666666666666666666666667d0*q(m,i-1) + &
               1.0833333333333333333333333333333333d0*q(m,i-2) - 0.25d0*q(m,i-3)
          fs0 = (fr0*omega0 + fr1*omega1 + fr2*omega2 + fr3*omega3)/(omega0 + omega1 + &
               omega2 + omega3)
          fs1 = (fr4*omega4 + fr5*omega5 + fr6*omega6 + fr7*omega7)/(omega4 + omega5 + &
               omega6 + omega7)
          ql(m,i) = fs0
          qr(m,i) = fs1
       end do
    end do

  end subroutine weno7

  subroutine weno9(q, ql, qr, num_eqn, maxnx, num_ghost)

    implicit none

    integer,          intent(in)  :: num_eqn, maxnx, num_ghost
    double precision, intent(in)  :: q(num_eqn,maxnx+2*num_ghost)
    double precision, intent(out) :: ql(num_eqn,maxnx+2*num_ghost), qr(num_eqn,maxnx+2*num_ghost)

    integer :: i, m
    double precision :: sigma0, &
         sigma1, &
         sigma2, &
         sigma3, &
         sigma4, &
         omega1, &
         omega7, &
         omega0, &
         omega6, &
         omega9, &
         omega2, &
         omega8, &
         omega4, &
         omega3, &
         omega5, &
         fr1, &
         fr7, &
         fr0, &
         fr6, &
         fr9, &
         fr2, &
         fr8, &
         fr4, &
         fr3, &
         fr5, &
         fs0, &
         fs1

    do i = num_ghost-1, maxnx+num_ghost+1
       do m = 1, num_eqn
          sigma0 = 21.412301587301587301587301587301587d0*q(m,i+0)*q(m,i+0) - &
               128.86924603174603174603174603174603d0*q(m,i+0)*q(m,i+1) + &
               150.56011904761904761904761904761905d0*q(m,i+0)*q(m,i+2) - &
               81.644246031746031746031746031746032d0*q(m,i+0)*q(m,i+3) + &
               17.128769841269841269841269841269841d0*q(m,i+0)*q(m,i+4) + &
               202.49265873015873015873015873015873d0*q(m,i+1)*q(m,i+1) - &
               488.50714285714285714285714285714286d0*q(m,i+1)*q(m,i+2) + &
               269.53531746031746031746031746031746d0*q(m,i+1)*q(m,i+3) - &
               57.144246031746031746031746031746032d0*q(m,i+1)*q(m,i+4) + &
               301.86369047619047619047619047619048d0*q(m,i+2)*q(m,i+2) - &
               338.17380952380952380952380952380952d0*q(m,i+2)*q(m,i+3) + &
               72.393452380952380952380952380952381d0*q(m,i+2)*q(m,i+4) + &
               95.825992063492063492063492063492063d0*q(m,i+3)*q(m,i+3) - &
               41.369246031746031746031746031746032d0*q(m,i+3)*q(m,i+4) + &
               4.4956349206349206349206349206349206d0*q(m,i+4)*q(m,i+4)
          sigma1 = 48.159325396825396825396825396825397d0*q(m,i+0)*q(m,i+0) - &
               121.42380952380952380952380952380952d0*q(m,i+0)*q(m,i+1) + &
               66.868650793650793650793650793650794d0*q(m,i+0)*q(m,i+2) - &
               13.935912698412698412698412698412698d0*q(m,i+0)*q(m,i+3) - &
               27.827579365079365079365079365079365d0*q(m,i+0)*q(m,i-1) + &
               80.613690476190476190476190476190476d0*q(m,i+1)*q(m,i+1) - &
               92.257142857142857142857142857142857d0*q(m,i+1)*q(m,i+2) + &
               19.685119047619047619047619047619048d0*q(m,i+1)*q(m,i+3) + &
               32.768452380952380952380952380952381d0*q(m,i+1)*q(m,i-1) + &
               27.49265873015873015873015873015873d0*q(m,i+2)*q(m,i+2) - &
               12.077579365079365079365079365079365d0*q(m,i+2)*q(m,i+3) - &
               17.519246031746031746031746031746032d0*q(m,i+2)*q(m,i-1) + &
               1.3706349206349206349206349206349206d0*q(m,i+3)*q(m,i+3) + &
               3.5871031746031746031746031746031746d0*q(m,i+3)*q(m,i-1) + &
               4.4956349206349206349206349206349206d0*q(m,i-1)*q(m,i-1)
          sigma2 = 45.863690476190476190476190476190476d0*q(m,i+0)*q(m,i+0) - &
               59.34047619047619047619047619047619d0*q(m,i+0)*q(m,i+1) + &
               13.476785714285714285714285714285714d0*q(m,i+0)*q(m,i+2) - &
               59.34047619047619047619047619047619d0*q(m,i+0)*q(m,i-1) + &
               13.476785714285714285714285714285714d0*q(m,i+0)*q(m,i-2) + &
               20.825992063492063492063492063492063d0*q(m,i+1)*q(m,i+1) - &
               10.119246031746031746031746031746032d0*q(m,i+1)*q(m,i+2) + &
               35.53531746031746031746031746031746d0*q(m,i+1)*q(m,i-1) - &
               7.7275793650793650793650793650793651d0*q(m,i+1)*q(m,i-2) + &
               1.3706349206349206349206349206349206d0*q(m,i+2)*q(m,i+2) - &
               7.7275793650793650793650793650793651d0*q(m,i+2)*q(m,i-1) + &
               1.6287698412698412698412698412698413d0*q(m,i+2)*q(m,i-2) + &
               20.825992063492063492063492063492063d0*q(m,i-1)*q(m,i-1) - &
               10.119246031746031746031746031746032d0*q(m,i-1)*q(m,i-2) + &
               1.3706349206349206349206349206349206d0*q(m,i-2)*q(m,i-2)
          sigma3 = 48.159325396825396825396825396825397d0*q(m,i+0)*q(m,i+0) - &
               27.827579365079365079365079365079365d0*q(m,i+0)*q(m,i+1) - &
               121.42380952380952380952380952380952d0*q(m,i+0)*q(m,i-1) + &
               66.868650793650793650793650793650794d0*q(m,i+0)*q(m,i-2) - &
               13.935912698412698412698412698412698d0*q(m,i+0)*q(m,i-3) + &
               4.4956349206349206349206349206349206d0*q(m,i+1)*q(m,i+1) + &
               32.768452380952380952380952380952381d0*q(m,i+1)*q(m,i-1) - &
               17.519246031746031746031746031746032d0*q(m,i+1)*q(m,i-2) + &
               3.5871031746031746031746031746031746d0*q(m,i+1)*q(m,i-3) + &
               80.613690476190476190476190476190476d0*q(m,i-1)*q(m,i-1) - &
               92.257142857142857142857142857142857d0*q(m,i-1)*q(m,i-2) + &
               19.685119047619047619047619047619048d0*q(m,i-1)*q(m,i-3) + &
               27.49265873015873015873015873015873d0*q(m,i-2)*q(m,i-2) - &
               12.077579365079365079365079365079365d0*q(m,i-2)*q(m,i-3) + &
               1.3706349206349206349206349206349206d0*q(m,i-3)*q(m,i-3)
          sigma4 = 21.412301587301587301587301587301587d0*q(m,i+0)*q(m,i+0) - &
               128.86924603174603174603174603174603d0*q(m,i+0)*q(m,i-1) + &
               150.56011904761904761904761904761905d0*q(m,i+0)*q(m,i-2) - &
               81.644246031746031746031746031746032d0*q(m,i+0)*q(m,i-3) + &
               17.128769841269841269841269841269841d0*q(m,i+0)*q(m,i-4) + &
               202.49265873015873015873015873015873d0*q(m,i-1)*q(m,i-1) - &
               488.50714285714285714285714285714286d0*q(m,i-1)*q(m,i-2) + &
               269.53531746031746031746031746031746d0*q(m,i-1)*q(m,i-3) - &
               57.144246031746031746031746031746032d0*q(m,i-1)*q(m,i-4) + &
               301.86369047619047619047619047619048d0*q(m,i-2)*q(m,i-2) - &
               338.17380952380952380952380952380952d0*q(m,i-2)*q(m,i-3) + &
               72.393452380952380952380952380952381d0*q(m,i-2)*q(m,i-4) + &
               95.825992063492063492063492063492063d0*q(m,i-3)*q(m,i-3) - &
               41.369246031746031746031746031746032d0*q(m,i-3)*q(m,i-4) + &
               4.4956349206349206349206349206349206d0*q(m,i-4)*q(m,i-4)
          omega0 = 0.0079365079365079365079365079365079365d0/(sigma0 + &
               0.00000099999999999999995474811182588625869d0)*(sigma0 + &
               0.00000099999999999999995474811182588625869d0)
          omega1 = 0.15873015873015873015873015873015873d0/(sigma1 + &
               0.00000099999999999999995474811182588625869d0)*(sigma1 + &
               0.00000099999999999999995474811182588625869d0)
          omega2 = 0.47619047619047619047619047619047619d0/(sigma2 + &
               0.00000099999999999999995474811182588625869d0)*(sigma2 + &
               0.00000099999999999999995474811182588625869d0)
          omega3 = 0.31746031746031746031746031746031746d0/(sigma3 + &
               0.00000099999999999999995474811182588625869d0)*(sigma3 + &
               0.00000099999999999999995474811182588625869d0)
          omega4 = 0.039682539682539682539682539682539683d0/(sigma4 + &
               0.00000099999999999999995474811182588625869d0)*(sigma4 + &
               0.00000099999999999999995474811182588625869d0)
          omega5 = 0.039682539682539682539682539682539683d0/(sigma0 + &
               0.00000099999999999999995474811182588625869d0)*(sigma0 + &
               0.00000099999999999999995474811182588625869d0)
          omega6 = 0.31746031746031746031746031746031746d0/(sigma1 + &
               0.00000099999999999999995474811182588625869d0)*(sigma1 + &
               0.00000099999999999999995474811182588625869d0)
          omega7 = 0.47619047619047619047619047619047619d0/(sigma2 + &
               0.00000099999999999999995474811182588625869d0)*(sigma2 + &
               0.00000099999999999999995474811182588625869d0)
          omega8 = 0.15873015873015873015873015873015873d0/(sigma3 + &
               0.00000099999999999999995474811182588625869d0)*(sigma3 + &
               0.00000099999999999999995474811182588625869d0)
          omega9 = 0.0079365079365079365079365079365079365d0/(sigma4 + &
               0.00000099999999999999995474811182588625869d0)*(sigma4 + &
               0.00000099999999999999995474811182588625869d0)
          fr0 = 2.2833333333333333333333333333333333d0*q(m,i+0) - &
               2.7166666666666666666666666666666667d0*q(m,i+1) + &
               2.2833333333333333333333333333333333d0*q(m,i+2) - 1.05d0*q(m,i+3 &
               ) + 0.2d0*q(m,i+4)
          fr1 = 1.2833333333333333333333333333333333d0*q(m,i+0) - &
               0.71666666666666666666666666666666667d0*q(m,i+1) + &
               0.28333333333333333333333333333333333d0*q(m,i+2) - 0.05d0*q(m,i+3 &
               ) + 0.2d0*q(m,i-1)
          fr2 = 0.78333333333333333333333333333333333d0*q(m,i+0) - &
               0.21666666666666666666666666666666667d0*q(m,i+1) + &
               0.033333333333333333333333333333333333d0*q(m,i+2) + 0.45d0*q(m, &
               i-1) - 0.05d0*q(m,i-2)
          fr3 = 0.45d0*q(m,i+0) - 0.05d0*q(m,i+1) + &
               0.78333333333333333333333333333333333d0*q(m,i-1) - &
               0.21666666666666666666666666666666667d0*q(m,i-2) + &
               0.033333333333333333333333333333333333d0*q(m,i-3)
          fr4 = 0.2d0*q(m,i+0) + 1.2833333333333333333333333333333333d0*q(m,i-1) - &
               0.71666666666666666666666666666666667d0*q(m,i-2) + &
               0.28333333333333333333333333333333333d0*q(m,i-3) - 0.05d0*q(m,i-4 &
               )
          fr5 = 0.2d0*q(m,i+0) + 1.2833333333333333333333333333333333d0*q(m,i+1) - &
               0.71666666666666666666666666666666667d0*q(m,i+2) + &
               0.28333333333333333333333333333333333d0*q(m,i+3) - 0.05d0*q(m,i+4 &
               )
          fr6 = 0.45d0*q(m,i+0) + 0.78333333333333333333333333333333333d0*q(m,i+1) - &
               0.21666666666666666666666666666666667d0*q(m,i+2) + &
               0.033333333333333333333333333333333333d0*q(m,i+3) - 0.05d0*q(m, &
               i-1)
          fr7 = 0.78333333333333333333333333333333333d0*q(m,i+0) + 0.45d0*q(m,i+1) - &
               0.05d0*q(m,i+2) - 0.21666666666666666666666666666666667d0*q(m,i-1 &
               ) + 0.033333333333333333333333333333333333d0*q(m,i-2)
          fr8 = 1.2833333333333333333333333333333333d0*q(m,i+0) + 0.2d0*q(m,i+1) - &
               0.71666666666666666666666666666666667d0*q(m,i-1) + &
               0.28333333333333333333333333333333333d0*q(m,i-2) - 0.05d0*q(m,i-3 &
               )
          fr9 = 2.2833333333333333333333333333333333d0*q(m,i+0) - &
               2.7166666666666666666666666666666667d0*q(m,i-1) + &
               2.2833333333333333333333333333333333d0*q(m,i-2) - 1.05d0*q(m,i-3 &
               ) + 0.2d0*q(m,i-4)
          fs0 = (fr0*omega0 + fr1*omega1 + fr2*omega2 + fr3*omega3 + fr4*omega4)/(omega0 &
               + omega1 + omega2 + omega3 + omega4)
          fs1 = (fr5*omega5 + fr6*omega6 + fr7*omega7 + fr8*omega8 + fr9*omega9)/(omega5 &
               + omega6 + omega7 + omega8 + omega9)
          ql(m,i) = fs0
          qr(m,i) = fs1
       end do
    end do

  end subroutine weno9

  subroutine weno5_mapped(q, ql, qr, num_eqn, maxnx, num_ghost, beta, varpi, coeffs)

    implicit none

    integer,          intent(in)  :: num_eqn, maxnx, num_ghost
    double precision, intent(in)  :: q(num_eqn,maxnx+2*num_ghost)
    double precision, intent(out) :: ql(num_eqn,maxnx+2*num_ghost), qr(num_eqn,maxnx+2*num_ghost)
    double precision, intent(in)  :: &
         beta(maxnx+2*num_ghost,0:3-1,0:3-1,0:3-1), &
         varpi(maxnx+2*num_ghost,0:1,0:3-1), &
         coeffs(maxnx+2*num_ghost,0:1,0:3-1,0:3-1)

    integer :: i, m
    double precision :: sigma0, &
         sigma1, &
         sigma2, &
         omega1, &
         omega5, &
         omega0, &
         omega4, &
         omega3, &
         omega2, &
         fr1, &
         fr5, &
         fr0, &
         fr4, &
         fr3, &
         fr2, &
         fs0, &
         fs1

    do i = num_ghost-1, maxnx+num_ghost+1
       do m = 1, num_eqn
          sigma0 = beta(i,0,0,0)*q(m,i+0)*q(m,i+0) + beta(i,0,0,1)*q(m,i+0)*q(m,i+1) + beta &
               (i,0,0,2)*q(m,i+0)*q(m,i+2) + beta(i,0,1,1)*q(m,i+1)*q(m,i+1) + &
               beta(i,0,1,2)*q(m,i+1)*q(m,i+2) + beta(i,0,2,2)*q(m,i+2)*q(m,i+2)
          sigma1 = beta(i,1,0,0)*q(m,i-1)*q(m,i-1) + beta(i,1,0,1)*q(m,i+0)*q(m,i-1) + beta &
               (i,1,0,2)*q(m,i+1)*q(m,i-1) + beta(i,1,1,1)*q(m,i+0)*q(m,i+0) + &
               beta(i,1,1,2)*q(m,i+0)*q(m,i+1) + beta(i,1,2,2)*q(m,i+1)*q(m,i+1)
          sigma2 = beta(i,2,0,0)*q(m,i-2)*q(m,i-2) + beta(i,2,0,1)*q(m,i-1)*q(m,i-2) + beta &
               (i,2,0,2)*q(m,i+0)*q(m,i-2) + beta(i,2,1,1)*q(m,i-1)*q(m,i-1) + &
               beta(i,2,1,2)*q(m,i+0)*q(m,i-1) + beta(i,2,2,2)*q(m,i+0)*q(m,i+0)
          omega0 = varpi(i,0,0)/(sigma0 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma0 + 0.00000099999999999999995474811182588625869d0)
          omega1 = varpi(i,0,1)/(sigma1 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma1 + 0.00000099999999999999995474811182588625869d0)
          omega2 = varpi(i,0,2)/(sigma2 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma2 + 0.00000099999999999999995474811182588625869d0)
          omega3 = varpi(i,1,0)/(sigma0 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma0 + 0.00000099999999999999995474811182588625869d0)
          omega4 = varpi(i,1,1)/(sigma1 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma1 + 0.00000099999999999999995474811182588625869d0)
          omega5 = varpi(i,1,2)/(sigma2 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma2 + 0.00000099999999999999995474811182588625869d0)
          fr0 = coeffs(i,0,0,0)*q(m,i+0) + coeffs(i,0,0,1)*q(m,i+1) + coeffs(i,0,0,2)*q( &
               m,i+2)
          fr1 = coeffs(i,0,1,0)*q(m,i-1) + coeffs(i,0,1,1)*q(m,i+0) + coeffs(i,0,1,2)*q( &
               m,i+1)
          fr2 = coeffs(i,0,2,0)*q(m,i-2) + coeffs(i,0,2,1)*q(m,i-1) + coeffs(i,0,2,2)*q( &
               m,i+0)
          fr3 = coeffs(i,1,0,0)*q(m,i+0) + coeffs(i,1,0,1)*q(m,i+1) + coeffs(i,1,0,2)*q( &
               m,i+2)
          fr4 = coeffs(i,1,1,0)*q(m,i-1) + coeffs(i,1,1,1)*q(m,i+0) + coeffs(i,1,1,2)*q( &
               m,i+1)
          fr5 = coeffs(i,1,2,0)*q(m,i-2) + coeffs(i,1,2,1)*q(m,i-1) + coeffs(i,1,2,2)*q( &
               m,i+0)
          fs0 = (fr0*omega0 + fr1*omega1 + fr2*omega2)/(omega0 + omega1 + omega2)
          fs1 = (fr3*omega3 + fr4*omega4 + fr5*omega5)/(omega3 + omega4 + omega5)
          ql(m,i) = fs0
          qr(m,i) = fs1
       end do
    end do

  end subroutine weno5_mapped

  subroutine weno7_mapped(q, ql, qr, num_eqn, maxnx, num_ghost, beta, varpi, coeffs)

    implicit none

    integer,          intent(in)  :: num_eqn, maxnx, num_ghost
    double precision, intent(in)  :: q(num_eqn,maxnx+2*num_ghost)
    double precision, intent(out) :: ql(num_eqn,maxnx+2*num_ghost), qr(num_eqn,maxnx+2*num_ghost)
    double precision, intent(in)  :: &
         beta(maxnx+2*num_ghost,0:4-1,0:4-1,0:4-1), &
         varpi(maxnx+2*num_ghost,0:1,0:4-1), &
         coeffs(maxnx+2*num_ghost,0:1,0:4-1,0:4-1)

    integer :: i, m
    double precision :: sigma0, &
         sigma1, &
         sigma2, &
         sigma3, &
         omega1, &
         omega6, &
         omega0, &
         omega2, &
         omega7, &
         omega4, &
         omega3, &
         omega5, &
         fr1, &
         fr6, &
         fr0, &
         fr2, &
         fr7, &
         fr4, &
         fr3, &
         fr5, &
         fs0, &
         fs1

    do i = num_ghost-1, maxnx+num_ghost+1
       do m = 1, num_eqn
          sigma0 = beta(i,0,0,0)*q(m,i+0)*q(m,i+0) + beta(i,0,0,1)*q(m,i+0)*q(m,i+1) + beta &
               (i,0,0,2)*q(m,i+0)*q(m,i+2) + beta(i,0,0,3)*q(m,i+0)*q(m,i+3) + &
               beta(i,0,1,1)*q(m,i+1)*q(m,i+1) + beta(i,0,1,2)*q(m,i+1)*q(m,i+2 &
               ) + beta(i,0,1,3)*q(m,i+1)*q(m,i+3) + beta(i,0,2,2)*q(m,i+2)*q(m, &
               i+2) + beta(i,0,2,3)*q(m,i+2)*q(m,i+3) + beta(i,0,3,3)*q(m,i+3)*q &
               (m,i+3)
          sigma1 = beta(i,1,0,0)*q(m,i-1)*q(m,i-1) + beta(i,1,0,1)*q(m,i+0)*q(m,i-1) + beta &
               (i,1,0,2)*q(m,i+1)*q(m,i-1) + beta(i,1,0,3)*q(m,i+2)*q(m,i-1) + &
               beta(i,1,1,1)*q(m,i+0)*q(m,i+0) + beta(i,1,1,2)*q(m,i+0)*q(m,i+1 &
               ) + beta(i,1,1,3)*q(m,i+0)*q(m,i+2) + beta(i,1,2,2)*q(m,i+1)*q(m, &
               i+1) + beta(i,1,2,3)*q(m,i+1)*q(m,i+2) + beta(i,1,3,3)*q(m,i+2)*q &
               (m,i+2)
          sigma2 = beta(i,2,0,0)*q(m,i-2)*q(m,i-2) + beta(i,2,0,1)*q(m,i-1)*q(m,i-2) + beta &
               (i,2,0,2)*q(m,i+0)*q(m,i-2) + beta(i,2,0,3)*q(m,i+1)*q(m,i-2) + &
               beta(i,2,1,1)*q(m,i-1)*q(m,i-1) + beta(i,2,1,2)*q(m,i+0)*q(m,i-1 &
               ) + beta(i,2,1,3)*q(m,i+1)*q(m,i-1) + beta(i,2,2,2)*q(m,i+0)*q(m, &
               i+0) + beta(i,2,2,3)*q(m,i+0)*q(m,i+1) + beta(i,2,3,3)*q(m,i+1)*q &
               (m,i+1)
          sigma3 = beta(i,3,0,0)*q(m,i-3)*q(m,i-3) + beta(i,3,0,1)*q(m,i-2)*q(m,i-3) + beta &
               (i,3,0,2)*q(m,i-1)*q(m,i-3) + beta(i,3,0,3)*q(m,i+0)*q(m,i-3) + &
               beta(i,3,1,1)*q(m,i-2)*q(m,i-2) + beta(i,3,1,2)*q(m,i-1)*q(m,i-2 &
               ) + beta(i,3,1,3)*q(m,i+0)*q(m,i-2) + beta(i,3,2,2)*q(m,i-1)*q(m, &
               i-1) + beta(i,3,2,3)*q(m,i+0)*q(m,i-1) + beta(i,3,3,3)*q(m,i+0)*q &
               (m,i+0)
          omega0 = varpi(i,0,0)/(sigma0 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma0 + 0.00000099999999999999995474811182588625869d0)
          omega1 = varpi(i,0,1)/(sigma1 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma1 + 0.00000099999999999999995474811182588625869d0)
          omega2 = varpi(i,0,2)/(sigma2 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma2 + 0.00000099999999999999995474811182588625869d0)
          omega3 = varpi(i,0,3)/(sigma3 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma3 + 0.00000099999999999999995474811182588625869d0)
          omega4 = varpi(i,1,0)/(sigma0 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma0 + 0.00000099999999999999995474811182588625869d0)
          omega5 = varpi(i,1,1)/(sigma1 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma1 + 0.00000099999999999999995474811182588625869d0)
          omega6 = varpi(i,1,2)/(sigma2 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma2 + 0.00000099999999999999995474811182588625869d0)
          omega7 = varpi(i,1,3)/(sigma3 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma3 + 0.00000099999999999999995474811182588625869d0)
          fr0 = coeffs(i,0,0,0)*q(m,i+0) + coeffs(i,0,0,1)*q(m,i+1) + coeffs(i,0,0,2)*q( &
               m,i+2) + coeffs(i,0,0,3)*q(m,i+3)
          fr1 = coeffs(i,0,1,0)*q(m,i-1) + coeffs(i,0,1,1)*q(m,i+0) + coeffs(i,0,1,2)*q( &
               m,i+1) + coeffs(i,0,1,3)*q(m,i+2)
          fr2 = coeffs(i,0,2,0)*q(m,i-2) + coeffs(i,0,2,1)*q(m,i-1) + coeffs(i,0,2,2)*q( &
               m,i+0) + coeffs(i,0,2,3)*q(m,i+1)
          fr3 = coeffs(i,0,3,0)*q(m,i-3) + coeffs(i,0,3,1)*q(m,i-2) + coeffs(i,0,3,2)*q( &
               m,i-1) + coeffs(i,0,3,3)*q(m,i+0)
          fr4 = coeffs(i,1,0,0)*q(m,i+0) + coeffs(i,1,0,1)*q(m,i+1) + coeffs(i,1,0,2)*q( &
               m,i+2) + coeffs(i,1,0,3)*q(m,i+3)
          fr5 = coeffs(i,1,1,0)*q(m,i-1) + coeffs(i,1,1,1)*q(m,i+0) + coeffs(i,1,1,2)*q( &
               m,i+1) + coeffs(i,1,1,3)*q(m,i+2)
          fr6 = coeffs(i,1,2,0)*q(m,i-2) + coeffs(i,1,2,1)*q(m,i-1) + coeffs(i,1,2,2)*q( &
               m,i+0) + coeffs(i,1,2,3)*q(m,i+1)
          fr7 = coeffs(i,1,3,0)*q(m,i-3) + coeffs(i,1,3,1)*q(m,i-2) + coeffs(i,1,3,2)*q( &
               m,i-1) + coeffs(i,1,3,3)*q(m,i+0)
          fs0 = (fr0*omega0 + fr1*omega1 + fr2*omega2 + fr3*omega3)/(omega0 + omega1 + &
               omega2 + omega3)
          fs1 = (fr4*omega4 + fr5*omega5 + fr6*omega6 + fr7*omega7)/(omega4 + omega5 + &
               omega6 + omega7)
          ql(m,i) = fs0
          qr(m,i) = fs1
       end do
    end do

  end subroutine weno7_mapped

  subroutine weno9_mapped(q, ql, qr, num_eqn, maxnx, num_ghost, beta, varpi, coeffs)

    implicit none

    integer,          intent(in)  :: num_eqn, maxnx, num_ghost
    double precision, intent(in)  :: q(num_eqn,maxnx+2*num_ghost)
    double precision, intent(out) :: ql(num_eqn,maxnx+2*num_ghost), qr(num_eqn,maxnx+2*num_ghost)
    double precision, intent(in)  :: &
         beta(maxnx+2*num_ghost,0:5-1,0:5-1,0:5-1), &
         varpi(maxnx+2*num_ghost,0:1,0:5-1), &
         coeffs(maxnx+2*num_ghost,0:1,0:5-1,0:5-1)

    integer :: i, m
    double precision :: sigma0, &
         sigma1, &
         sigma2, &
         sigma3, &
         sigma4, &
         omega1, &
         omega7, &
         omega0, &
         omega6, &
         omega9, &
         omega2, &
         omega8, &
         omega4, &
         omega3, &
         omega5, &
         fr1, &
         fr7, &
         fr0, &
         fr6, &
         fr9, &
         fr2, &
         fr8, &
         fr4, &
         fr3, &
         fr5, &
         fs0, &
         fs1

    do i = num_ghost-1, maxnx+num_ghost+1
       do m = 1, num_eqn
          sigma0 = beta(i,0,0,0)*q(m,i+0)*q(m,i+0) + beta(i,0,0,1)*q(m,i+0)*q(m,i+1) + beta &
               (i,0,0,2)*q(m,i+0)*q(m,i+2) + beta(i,0,0,3)*q(m,i+0)*q(m,i+3) + &
               beta(i,0,0,4)*q(m,i+0)*q(m,i+4) + beta(i,0,1,1)*q(m,i+1)*q(m,i+1 &
               ) + beta(i,0,1,2)*q(m,i+1)*q(m,i+2) + beta(i,0,1,3)*q(m,i+1)*q(m, &
               i+3) + beta(i,0,1,4)*q(m,i+1)*q(m,i+4) + beta(i,0,2,2)*q(m,i+2)*q &
               (m,i+2) + beta(i,0,2,3)*q(m,i+2)*q(m,i+3) + beta(i,0,2,4)*q(m,i+2 &
               )*q(m,i+4) + beta(i,0,3,3)*q(m,i+3)*q(m,i+3) + beta(i,0,3,4)*q(m, &
               i+3)*q(m,i+4) + beta(i,0,4,4)*q(m,i+4)*q(m,i+4)
          sigma1 = beta(i,1,0,0)*q(m,i-1)*q(m,i-1) + beta(i,1,0,1)*q(m,i+0)*q(m,i-1) + beta &
               (i,1,0,2)*q(m,i+1)*q(m,i-1) + beta(i,1,0,3)*q(m,i+2)*q(m,i-1) + &
               beta(i,1,0,4)*q(m,i+3)*q(m,i-1) + beta(i,1,1,1)*q(m,i+0)*q(m,i+0 &
               ) + beta(i,1,1,2)*q(m,i+0)*q(m,i+1) + beta(i,1,1,3)*q(m,i+0)*q(m, &
               i+2) + beta(i,1,1,4)*q(m,i+0)*q(m,i+3) + beta(i,1,2,2)*q(m,i+1)*q &
               (m,i+1) + beta(i,1,2,3)*q(m,i+1)*q(m,i+2) + beta(i,1,2,4)*q(m,i+1 &
               )*q(m,i+3) + beta(i,1,3,3)*q(m,i+2)*q(m,i+2) + beta(i,1,3,4)*q(m, &
               i+2)*q(m,i+3) + beta(i,1,4,4)*q(m,i+3)*q(m,i+3)
          sigma2 = beta(i,2,0,0)*q(m,i-2)*q(m,i-2) + beta(i,2,0,1)*q(m,i-1)*q(m,i-2) + beta &
               (i,2,0,2)*q(m,i+0)*q(m,i-2) + beta(i,2,0,3)*q(m,i+1)*q(m,i-2) + &
               beta(i,2,0,4)*q(m,i+2)*q(m,i-2) + beta(i,2,1,1)*q(m,i-1)*q(m,i-1 &
               ) + beta(i,2,1,2)*q(m,i+0)*q(m,i-1) + beta(i,2,1,3)*q(m,i+1)*q(m, &
               i-1) + beta(i,2,1,4)*q(m,i+2)*q(m,i-1) + beta(i,2,2,2)*q(m,i+0)*q &
               (m,i+0) + beta(i,2,2,3)*q(m,i+0)*q(m,i+1) + beta(i,2,2,4)*q(m,i+0 &
               )*q(m,i+2) + beta(i,2,3,3)*q(m,i+1)*q(m,i+1) + beta(i,2,3,4)*q(m, &
               i+1)*q(m,i+2) + beta(i,2,4,4)*q(m,i+2)*q(m,i+2)
          sigma3 = beta(i,3,0,0)*q(m,i-3)*q(m,i-3) + beta(i,3,0,1)*q(m,i-2)*q(m,i-3) + beta &
               (i,3,0,2)*q(m,i-1)*q(m,i-3) + beta(i,3,0,3)*q(m,i+0)*q(m,i-3) + &
               beta(i,3,0,4)*q(m,i+1)*q(m,i-3) + beta(i,3,1,1)*q(m,i-2)*q(m,i-2 &
               ) + beta(i,3,1,2)*q(m,i-1)*q(m,i-2) + beta(i,3,1,3)*q(m,i+0)*q(m, &
               i-2) + beta(i,3,1,4)*q(m,i+1)*q(m,i-2) + beta(i,3,2,2)*q(m,i-1)*q &
               (m,i-1) + beta(i,3,2,3)*q(m,i+0)*q(m,i-1) + beta(i,3,2,4)*q(m,i+1 &
               )*q(m,i-1) + beta(i,3,3,3)*q(m,i+0)*q(m,i+0) + beta(i,3,3,4)*q(m, &
               i+0)*q(m,i+1) + beta(i,3,4,4)*q(m,i+1)*q(m,i+1)
          sigma4 = beta(i,4,0,0)*q(m,i-4)*q(m,i-4) + beta(i,4,0,1)*q(m,i-3)*q(m,i-4) + beta &
               (i,4,0,2)*q(m,i-2)*q(m,i-4) + beta(i,4,0,3)*q(m,i-1)*q(m,i-4) + &
               beta(i,4,0,4)*q(m,i+0)*q(m,i-4) + beta(i,4,1,1)*q(m,i-3)*q(m,i-3 &
               ) + beta(i,4,1,2)*q(m,i-2)*q(m,i-3) + beta(i,4,1,3)*q(m,i-1)*q(m, &
               i-3) + beta(i,4,1,4)*q(m,i+0)*q(m,i-3) + beta(i,4,2,2)*q(m,i-2)*q &
               (m,i-2) + beta(i,4,2,3)*q(m,i-1)*q(m,i-2) + beta(i,4,2,4)*q(m,i+0 &
               )*q(m,i-2) + beta(i,4,3,3)*q(m,i-1)*q(m,i-1) + beta(i,4,3,4)*q(m, &
               i+0)*q(m,i-1) + beta(i,4,4,4)*q(m,i+0)*q(m,i+0)
          omega0 = varpi(i,0,0)/(sigma0 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma0 + 0.00000099999999999999995474811182588625869d0)
          omega1 = varpi(i,0,1)/(sigma1 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma1 + 0.00000099999999999999995474811182588625869d0)
          omega2 = varpi(i,0,2)/(sigma2 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma2 + 0.00000099999999999999995474811182588625869d0)
          omega3 = varpi(i,0,3)/(sigma3 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma3 + 0.00000099999999999999995474811182588625869d0)
          omega4 = varpi(i,0,4)/(sigma4 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma4 + 0.00000099999999999999995474811182588625869d0)
          omega5 = varpi(i,1,0)/(sigma0 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma0 + 0.00000099999999999999995474811182588625869d0)
          omega6 = varpi(i,1,1)/(sigma1 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma1 + 0.00000099999999999999995474811182588625869d0)
          omega7 = varpi(i,1,2)/(sigma2 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma2 + 0.00000099999999999999995474811182588625869d0)
          omega8 = varpi(i,1,3)/(sigma3 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma3 + 0.00000099999999999999995474811182588625869d0)
          omega9 = varpi(i,1,4)/(sigma4 + 0.00000099999999999999995474811182588625869d0)*( &
               sigma4 + 0.00000099999999999999995474811182588625869d0)
          fr0 = coeffs(i,0,0,0)*q(m,i+0) + coeffs(i,0,0,1)*q(m,i+1) + coeffs(i,0,0,2)*q( &
               m,i+2) + coeffs(i,0,0,3)*q(m,i+3) + coeffs(i,0,0,4)*q(m,i+4)
          fr1 = coeffs(i,0,1,0)*q(m,i-1) + coeffs(i,0,1,1)*q(m,i+0) + coeffs(i,0,1,2)*q( &
               m,i+1) + coeffs(i,0,1,3)*q(m,i+2) + coeffs(i,0,1,4)*q(m,i+3)
          fr2 = coeffs(i,0,2,0)*q(m,i-2) + coeffs(i,0,2,1)*q(m,i-1) + coeffs(i,0,2,2)*q( &
               m,i+0) + coeffs(i,0,2,3)*q(m,i+1) + coeffs(i,0,2,4)*q(m,i+2)
          fr3 = coeffs(i,0,3,0)*q(m,i-3) + coeffs(i,0,3,1)*q(m,i-2) + coeffs(i,0,3,2)*q( &
               m,i-1) + coeffs(i,0,3,3)*q(m,i+0) + coeffs(i,0,3,4)*q(m,i+1)
          fr4 = coeffs(i,0,4,0)*q(m,i-4) + coeffs(i,0,4,1)*q(m,i-3) + coeffs(i,0,4,2)*q( &
               m,i-2) + coeffs(i,0,4,3)*q(m,i-1) + coeffs(i,0,4,4)*q(m,i+0)
          fr5 = coeffs(i,1,0,0)*q(m,i+0) + coeffs(i,1,0,1)*q(m,i+1) + coeffs(i,1,0,2)*q( &
               m,i+2) + coeffs(i,1,0,3)*q(m,i+3) + coeffs(i,1,0,4)*q(m,i+4)
          fr6 = coeffs(i,1,1,0)*q(m,i-1) + coeffs(i,1,1,1)*q(m,i+0) + coeffs(i,1,1,2)*q( &
               m,i+1) + coeffs(i,1,1,3)*q(m,i+2) + coeffs(i,1,1,4)*q(m,i+3)
          fr7 = coeffs(i,1,2,0)*q(m,i-2) + coeffs(i,1,2,1)*q(m,i-1) + coeffs(i,1,2,2)*q( &
               m,i+0) + coeffs(i,1,2,3)*q(m,i+1) + coeffs(i,1,2,4)*q(m,i+2)
          fr8 = coeffs(i,1,3,0)*q(m,i-3) + coeffs(i,1,3,1)*q(m,i-2) + coeffs(i,1,3,2)*q( &
               m,i-1) + coeffs(i,1,3,3)*q(m,i+0) + coeffs(i,1,3,4)*q(m,i+1)
          fr9 = coeffs(i,1,4,0)*q(m,i-4) + coeffs(i,1,4,1)*q(m,i-3) + coeffs(i,1,4,2)*q( &
               m,i-2) + coeffs(i,1,4,3)*q(m,i-1) + coeffs(i,1,4,4)*q(m,i+0)
          fs0 = (fr0*omega0 + fr1*omega1 + fr2*omega2 + fr3*omega3 + fr4*omega4)/(omega0 &
               + omega1 + omega2 + omega3 + omega4)
          fs1 = (fr5*omega5 + fr6*omega6 + fr7*omega7 + fr8*omega8 + fr9*omega9)/(omega5 &
               + omega6 + omega7 + omega8 + omega9)
          ql(m,i) = fs0
          qr(m,i) = fs1
       end do
    end do

  end subroutine weno9_mapped
end module weno
